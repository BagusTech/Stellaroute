"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};void function(t){function e(e,a){var i=e.data.wrapper;return i.trigger("gettingFiles"),a&&a.files?void i.trigger("gotFiles",[null,a]):void t.ajax({type:"GET",url:"/getFiles",dataType:"json",contentType:"application/json",data:a||{},success:function(t){i.trigger("gotFiles",[null,t])},error:function(t){i.trigger("gotFiles",[t])}})}function a(e,a,i){var n=e.data.wrapper,o=a;if(o.length>0){n.trigger("fileUploading");for(var r=new FormData,l=0;l<o.length;l++){var f=o[l];r.append("files",f,f.name)}r.append("filePath",n.prop("uploadFilePath")),t.ajax({url:"/upload",type:"POST",data:r,processData:!1,contentType:!1,success:function(){n.trigger("filesUploaded")},error:function(t){n.trigger("filesUploaded",[t])}})}else n.trigger("fileUploading",[!0])}function i(i,n){var o=t(i),r=n.fileUploading,l=n.filesUploaded,f=n.gettingFiles,d=n.gotFiles;r&&o.off("fileUploading").on("fileUploading",r),l&&o.off("filesUploaded").on("filesUploaded",l),f&&o.off("gettingFiles").on("gettingFiles",f),d&&o.off("gotFiles").on("gotFiles",d),o.off("uploadFiles").on("uploadFiles",{wrapper:o},a),o.off("getFiles").on("getFiles",{wrapper:o},e)}t.fn.s3=function(t){return this.each(function(e,a){i(a,t)})}}(jQuery.noConflict()),void function(t){function e(e,a){var i=t('[data-prefix="'+(e||"")+'"] > ul');a.forEach(function(t){0===i.find('> [data-prefix="'+(e||"")+t+'/"]').length&&i.append('\n\t\t\t\t\t<li data-prefix="'+(e||"")+t+'/">\n\t\t\t\t\t\t<i class="fa fa-folder" aria-hidden="true"></i>\n\t\t\t\t\t\t'+t+"\n\t\t\t\t\t\t<ul></ul>\n\t\t\t\t\t</li>\n\t\t\t\t")})}function a(t){return t>1073741824?Math.ceil(t/1024/1024/1024)+"gb":t>1048576?Math.ceil(t/1024/1024)+"mb":t>1024?Math.ceil(t/1024)+"kb":t+"b"}function i(t){var e=a(t.Size),i=t.Key,n="\n\t\t\t<div class='file-picker--image' duck-image-value=\""+i.replace("-thumb2","")+'">\n\t\t\t\t<div class="row">\n\t\t\t\t\t<div class="col-xs-4">\n\t\t\t\t\t\t<img class="image--content" src="https://s3-us-west-2.amazonaws.com/stellaroute/'+i+'" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-xs-8">\n\t\t\t\t\t\t<h3 class="image--name">'+i.split("/")[i.split("/").length-1].replace("-thumb2","")+'</h3>\n\t\t\t\t\t\t<h4 class="image--size">'+(e||"unknown")+"</h4>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t";return n}function n(t){return function(e){e.stopPropagation(),t.attr("disabled",!0).html('<i class="fa fa-spinner fa-spin"></i> Uploading...')}}function o(t,e,a){return function(i,n){return i.stopPropagation(),t.attr("disabled",!1).text(n?"Try Again":"Upload Another Image"),n?void e.text("Sorry, something went wrong uploading your image."):(e.attr("duck-images",!1),void a.trigger("getFiles"))}}function r(t){return function(e){e.stopPropagation(),t.html('<div class="p-Xl ta-C js-waiting"><i class="fa fa-spinner fa-spin"></div>')}}function l(a,n){var o=t('[data-file-manager="header"] h2');return function(t,r,l){if(r)return void n.text("Sorry, something went wrong getting the images.");var f=l.files,d=l.folder,p=l.subFolders;if(a.prop("uploadFilePath",d),o.text(d||"Root"),f){n.html("");var s=f.filter(function(t){return t.Key.indexOf("-thumb2.")>-1}).sort(function(t,e){return t.LastModified>e.LastModified?-1:t.LastModified<e.LastModified?1:0});e(d,p),s?s.forEach(function(t){n.append(i(t))}):n.text("Sorry, there aren't any images in this folder."),n.closest('[data-function*="scroll"]').trigger("initScroll")}}}function f(e,a){e.stopPropagation();for(var i=e.data.wrapper,n=e.data.filesList,o=e.data.uploadButton,r=i.prop("filesToUpload")||[],l=function(e,i){var l=a[e],f=n.find("li").filter(function(e,a){return t(a).attr("data-file-name")===l.name}).length>0;return f?{v:void 0}:(r.push(l),n.append("<li data-file-name='"+l.name+"'>"+l.name+"<button class='uploader--delete' data-uploader='delete'><i class='fa fa-times' aria-hidden='true'></i><span class='sr-only'>Remove File From Upload List</i></button></li>"),void o.prop("disabled",!1))},f=0,d=a.length;f<d;f++){var p=l(f,d);if("object"===("undefined"==typeof p?"undefined":_typeof(p)))return p.v}i.prop("filesToUpload",r)}function d(e,a){var i=t(e),d=i.find('[data-file-manager="content"]'),p=i.find('[data-file-manager="directory"]'),s=i.find('[data-file-manager="footer"] button'),u=i.find('[data-file-manager="uploader"]'),c=i.find('[data-uploader="file-drop"]'),g=i.find('[data-uploader="files"]'),v=i.find('[data-file-manager="upload"]'),m=i.find('[data-uploader="upload"]'),h=i.find('[data-file-manager="cancel"]'),y=t('<input type="file" multiple="true">'),F=a||{fileUploading:n(v),filesUploaded:o(v,d,i),gettingFiles:r(d),gotFiles:l(i,d)};v.add(h).on("click",function(){u.toggleClass("hidden"),s.toggleClass("hidden")}),i.on("filesAdded",{wrapper:i,filesList:g,uploadButton:m},f),p.on("click","[data-prefix]",function(e){e.stopPropagation();var a=t(e.target),n={folder:a.attr("data-prefix"),files:a.prop("files")};i.trigger("getFiles",[n])}),g.on("click",'[data-uploader="delete"]',function(e){e.stopPropagation(),e.preventDefault();var a=t(e.target).closest("li"),n=a.attr("data-file-name"),o=i.prop("filesToUpload")||[];o.forEach(function(t,e){if(t.name===n)return void o.splice(e,1)}),a.detach(),0===o.length&&m.prop("disabled",!0),i.prop("filesToUpload",o)}),c.on("dragenter",function(t){t.stopPropagation(),t.preventDefault(),c.addClass(".uploader--file-drop__active")}),c.on("dragleave",function(t){t.stopPropagation(),t.preventDefault(),c.removeClass(".uploader--file-drop__active")}),c.on("dragover",function(t){t.stopPropagation(),t.preventDefault();var e=void 0;try{e=t.originalEvent.dataTransfer.effectAllowed}catch(t){e=null}t.originalEvent.dataTransfer.dropEffect="move"===e||"linkMove"===e?"move":"copy"}),y.on("change",function(t){t.stopPropagation(),t.preventDefault(),i.trigger("filesAdded",[y[0].files])}),c.on("click",function(t){t.stopPropagation(),t.preventDefault(),y.click()}),c.on("drop",function(t){t.stopPropagation(),t.preventDefault(),i.trigger("filesAdded",[t.originalEvent.dataTransfer.files])}),m.on("click",function(t){t.stopPropagation(),t.preventDefault(),i.trigger("uploadFiles",[i.prop("filesToUpload")])}),i.s3(F),i.trigger("getFiles"),i.prop("fileManagerInitiated",!0)}t.fn.fileManager=function(t){return this.each(function(e,a){d(a,t)})},t(function(){t('[data-function*="file-manager"').fileManager()})}(jQuery.noConflict());
//# sourceMappingURL=fileManager.min.js.map
