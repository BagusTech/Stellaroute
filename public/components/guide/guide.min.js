"use strict";void function(e){function a(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=a.find('[data-sort="item"]'),d=e.data.expandeCollapseIcon,n=d.hasClass("fa-compress"),r=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="'+!!n+'"]').click(),t.addClass("guide-card--edit-mode"),d.toggleClass("fa-compress fa-expand"),r.removeClass("fa-pencil").addClass("fa-eye")}function t(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=e.data.expandeCollapseIcon,d=a.find(".js-card"),n=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="false"]').click(),t.removeClass("fa-expand").addClass("fa-compress"),n.hasClass("fa-eye")?d.trigger("exitEditMode"):d.trigger("enterEditMode"),n.toggleClass("fa-eye fa-pencil")}function d(e){e.data.cardsWrapper.find('[duck-button="add"]').addClass("hidden"),e.data.addCardIcon.removeClass("rotate-45")}function n(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=e.data.addCardIcon,n=a.find('[duck-button="add"]');n.removeClass("hidden"),t.hasClass("rotate-45")?d({data:{cardsWrapper:a,addCardIcon:t}}):t.addClass("rotate-45")}function r(a){var t=e(a),d=t.find('.panel-heading[role="tab"]'),n=t.find('[duck-field="style"] select'),r=t.find(".card-styles--preview"),c=t.find('[duck-type="string"] [duck-value]'),l=t.find(".js-card-title"),p=t.find('[duck-type="image"] [duck-value]'),f=t.find(".js-card-image"),u=t.find(".summernote"),g=t.find(".js-card-text"),m=t.find(".js-card-toggle");m.on("click",function(e){e.stopPropagation(),e.preventDefault(),t.parent().hasClass("guide-card--edit-mode")?t.trigger("exitEditMode"):t.trigger("enterEditMode")}),t.on("exitEditMode",function(){t.parent().removeClass("guide-card--edit-mode"),"false"===d.attr("aria-expanded")&&d.click()}),t.on("enterEditMode",function(){t.parent().addClass("guide-card--edit-mode")}),c.on("input",function(e){e.stopPropagation(),e.preventDefault(),l.text(c.val()||o)}),u.on("summernote.change",function(e,a){g.html(a||s)}),n.on("input",function(e){e.stopPropagation(),e.preventDefault(),r.removeClass("card-styles--preview__active"),t.find('.card-styles--preview[card-style="'+n.val()+'"]').addClass("card-styles--preview__active")}),p.on("change",function(a){a.stopPropagation(),a.preventDefault();var t=p.val()?"https://s3-us-west-2.amazonaws.com/stellaroute/"+p.val().replace(".","-medium."):i;f.each(function(a,d){var n=e(d);n.attr("style")?n.attr("style","background-image: url('"+t+"')"):n.attr("src",t)})}),t.on("click",".js-delete-card",function(a){a.stopPropagation(),a.preventDefault();var t=e(a.delegateTarget).parent().find(".js-delete-card-form");t.addClass("z-1").delay(10).addClass("o-1")}),t.parent().on("click",".js-cancel-delete",function(a){a.stopPropagation(),a.preventDefault();var t=e(a.delegateTarget).find(".js-delete-card-form");t.removeClass("o-1").delay(180).removeClass("z-1")})}var o="Card Title",s="This is where the <strong>Text</strong> for the card will go.",i="images/no-image.svg";e.fn.guideCard=function(){return this.each(function(e,a){r(a)})},e(function(){var d=e(".sub-header"),r=e("#GuideDetailsForm"),o=r.find('[duck-button="submit"]'),s=o.find(".fa"),i=r.find('[duck-button="edit"]'),c=i.find(".fa"),l=r.find('[duck-field="bannerImage"] [duck-value]'),p=e("#GuideCards"),f=p.find('[duck-button="submit"]'),u=f.find(".fa"),g=e(".js-guide-cards"),m=e(".js-expand-collapse"),v=m.find(".fa"),C=e(".js-preview-cards"),k=C.find(".fa"),h=e(".js-add-card-start"),y=h.find(".fa"),b=e('<div class="alert alert-danger p-A z-1 l-0 r-0 t-0">Something went wrong, please try again.</div>');e.ajax({url:"/renderPug",data:{file:"../views/guides/cards/_card.pug",locals:{isMe:!0,card:{style:"big",title:"New Card",text:"New card text goes here."}}},success:function(a){g.prop("ArrayItemTemplate",e(a))}}),e(".js-card").guideCard(),p.on("duck.form.submitted",function(e){e.stopPropagation(),u.toggleClass("fa-spinner fa-spin fa-floppy-o")}),p.on("duck.form.success",function(e){e.stopPropagation(),u.toggleClass("fa-spinner fa-spin fa-floppy-o"),f.prop("disabled",!1),g.find(".js-card").trigger("exitEditMode"),k.removeClass("fa-eye").addClass("fa-pencil")}),p.on("duck.form.error",function(e){e.stopPropagation();var a=b.clone();g.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),u.toggleClass("fa-spinner fa-spin fa-floppy-o"),f.prop("disabled",!1)}),h.on("click",{cardsWrapper:g,addCardIcon:y},n),m.on("click",{cardsWrapper:g,expandeCollapseIcon:v,previewCardsIcon:k},a),C.on("click",{cardsWrapper:g,expandeCollapseIcon:v,previewCardsIcon:k},t),i.on("click",function(e){e.stopPropagation(),e.preventDefault(),c.toggleClass("fa-eye fa-pencil")}),r.on("duck.form.submitted",function(e){e.stopPropagation(),s.toggleClass("hidden")}),r.on("duck.form.success",function(e){e.stopPropagation();var a="https://s3-us-west-2.amazonaws.com/stellaroute/"+l.val().replace(".jpg","-large.jpg");r.modal("hide"),d.css("background-image",'url("'+a+'")'),s.toggleClass("hidden"),o.prop("disabled",!1),i.click()}),r.on("duck.form.error",function(e){e.stopPropagation();var a=b.clone();r.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),s.toggleClass("hidden"),o.prop("disabled",!1)})})}(jQuery.noConflict());
//# sourceMappingURL=guide.min.js.map
