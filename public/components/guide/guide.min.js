"use strict";void function(e){function a(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=a.find('[data-sort="item"]'),d=e.data.expandeCollapseIcon,n=d.hasClass("fa-compress"),o=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="'+!!n+'"]').click(),t.addClass("guide-card--edit-mode"),d.toggleClass("fa-compress fa-expand"),o.removeClass("fa-pencil").addClass("fa-eye")}function t(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=e.data.expandeCollapseIcon,d=a.find(".js-card"),n=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="false"]').click(),t.removeClass("fa-expand").addClass("fa-compress"),n.hasClass("fa-eye")?d.trigger("exitEditMode"):d.trigger("enterEditMode"),n.toggleClass("fa-eye fa-pencil")}function d(e){e.data.cardsWrapper.find('[duck-button="add"]').addClass("hidden"),e.data.addCardIcon.removeClass("rotate-45")}function n(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=e.data.addCardIcon,n=a.find('[duck-button="add"]');n.removeClass("hidden"),t.hasClass("rotate-45")?d({data:{cardsWrapper:a,addCardIcon:t}}):t.addClass("rotate-45")}function o(a){var t=e(a),d=t.find('.panel-heading[role="tab"]'),n=t.find('[duck-field="style"] select'),o=t.find(".card-styles--preview"),i=t.find('[duck-type="string"] [duck-value]'),c=t.find(".js-card-title"),l=t.find('[duck-type="image"] [duck-value]'),p=t.find(".js-card-image"),u=t.find(".summernote"),f=t.find(".js-card-text"),g=t.find(".js-card-toggle");g.on("click",function(e){e.stopPropagation(),e.preventDefault(),t.parent().hasClass("guide-card--edit-mode")?t.trigger("exitEditMode"):t.trigger("enterEditMode")}),t.on("exitEditMode",function(){t.parent().removeClass("guide-card--edit-mode"),"false"===d.attr("aria-expanded")&&d.click()}),t.on("enterEditMode",function(){t.parent().addClass("guide-card--edit-mode")}),i.on("input",function(e){e.stopPropagation(),e.preventDefault(),c.text(i.val()||r)}),u.on("summernote.change",function(e,a){f.html(a)}),n.on("input",function(e){e.stopPropagation(),e.preventDefault(),o.removeClass("card-styles--preview__active"),t.find('.card-styles--preview[card-style="'+n.val()+'"]').addClass("card-styles--preview__active")}),l.on("change",function(a){a.stopPropagation(),a.preventDefault();var t=l.val()?"https://s3-us-west-2.amazonaws.com/stellaroute/"+l.val().replace(".","-medium."):s;p.each(function(a,d){var n=e(d);n.attr("style")?n.attr("style","background-image: url('"+t+"')"):n.attr("src",t)})}),t.on("click",".js-delete-card",function(a){a.stopPropagation(),a.preventDefault();var t=e(a.delegateTarget).parent().find(".js-delete-card-form");t.addClass("z-1").delay(10).addClass("o-1")}),t.parent().on("click",".js-cancel-delete",function(a){a.stopPropagation(),a.preventDefault();var t=e(a.delegateTarget).find(".js-delete-card-form");t.removeClass("o-1").delay(180).removeClass("z-1")})}var r="Card Title",s="images/no-image.svg";e.fn.guideCard=function(){return this.each(function(e,a){o(a)})},e(function(){var d=e(".sub-header"),o=e("#GuideDetailsForm"),r=o.find('[duck-button="submit"] .fa'),s=o.find('[duck-button="edit"]'),i=s.find(".fa"),c=o.find('[duck-field="bannerImage"] [duck-value]'),l=e("#GuideCards"),p=l.find('[duck-button="submit"]').find(".fa"),u=e(".js-guide-cards"),f=e(".js-expand-collapse"),g=f.find(".fa"),m=e(".js-preview-cards"),v=m.find(".fa"),C=e(".js-add-card-start"),k=C.find(".fa"),b=e('<div class="alert alert-danger p-A z-1 l-0 r-0 t-0">Something went wrong, please try again.</div>');e.ajax({url:"/renderPug",data:{file:"../views/guides/cards/_card.pug",locals:{isMe:!0,card:{style:"big",title:"New Card",text:"New card text goes here."},startInEditMode:!0}},success:function(a){u.prop("ArrayItemTemplate",e(a))}}),e(".js-card").guideCard(),l.on("duck.form.submitted",function(e){e.stopPropagation(),p.toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!0)}),l.on("duck.form.success",function(e){e.stopPropagation(),p.toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!1),u.find(".js-card").trigger("exitEditMode"),v.removeClass("fa-eye").addClass("fa-pencil")}),l.on("duck.form.error",function(e){e.stopPropagation();var a=b.clone();u.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),p.toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!1)}),C.on("click",{cardsWrapper:u,addCardIcon:k},n),f.on("click",{cardsWrapper:u,expandeCollapseIcon:g,previewCardsIcon:v},a),m.on("click",{cardsWrapper:u,expandeCollapseIcon:g,previewCardsIcon:v},t),s.on("click",function(e){e.stopPropagation(),e.preventDefault(),i.toggleClass("fa-eye fa-pencil")}),o.on("duck.form.submitted",function(e){e.stopPropagation(),r.toggleClass("hidden")}),o.on("duck.form.success",function(e){e.stopPropagation();var a="https://s3-us-west-2.amazonaws.com/stellaroute/"+c.val().replace(".jpg","-large.jpg");o.modal("hide"),d.css("background-image",'url("'+a+'")'),r.toggleClass("hidden"),o.find('[duck-button="submit"]').prop("disabled",!1),s.click()}),o.on("duck.form.error",function(e){e.stopPropagation();var a=b.clone();o.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),r.toggleClass("hidden"),o.find('[duck-button="submit"]').prop("disabled",!1)})})}(jQuery.noConflict());
//# sourceMappingURL=guide.min.js.map
