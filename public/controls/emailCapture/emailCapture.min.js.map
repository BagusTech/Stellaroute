{"version":3,"sources":["controls/emailCapture/emailCapture.js"],"names":["$","$errorMessage","ajax","type","JSON","stringify","user","data","url","contentType","$wrapper","trigger","$form","find","$submit","click","e","stopPropagation","preventDefault","$emailInput","val","local","email","created","Date","recieveNewsletter","attr","addUser","on","success","hide","text","slideDown","jQuery","noConflict"],"mappings":"iBAAA,UAAAA,GASC,QAAMC,GAAAA,GAGLD,EAAEE,MADHC,KAAA,OACCH,KAAOI,KAAAC,UAAAC,GACNH,IAAAA,iBACAI,YAAWF,mBACXG,QAAK,WACLC,EAAAA,QAAa,0BAJP,IAMLC,MAAAA,WANKA,EAAAC,QAAA,0BAAA,MATR,GAAAD,GAAAV,EAAA,kBAGMY,EAAQF,EAASG,KAAK,QADtBH,EAAWV,EAAEa,KAAA,UACbD,EAAQF,EAAcG,KAAA,uBACtBC,EAAgBD,EAAKA,KAA3B,oBAiBCC,GAAAC,MAAA,SAAAC,GAGAA,EAAEC,kBADHH,EAAAA,iBAECE,EAAEE,KAAAA,YAAF,EAEAJ,IAAAA,GAAaK,EAAYC,MAGnBd,GADNe,OACAC,MAAAA,GAEEA,mBAAAA,EADMC,QADK,GAAAC,MAIZC,OAAAA,QAAAA,EAJYC,KAAA,kBAAAC,GAAbrB,KAUAI,EAjBDkB,GAAA,yBAAA,SAAAZ,EAAAa,GAoBCb,EAAEC,kBAAAA,GAGDL,EAAMkB,OADPpB,EAAGmB,KAAS,8BAAAC,OACXlB,EAAMkB,KAAN,0BAAAC,KAAA,8FAEArB,EAAAA,KAAA,YAAc,GAHfS,EAIOC,IAAA,IACNN,EAAakB,UAAb,SAGAC,OAAAC","file":"emailCapture.min.js","sourcesContent":["/* global jQuery */\r\n\r\nvoid function initEmailCapture($) {\r\n\t'use strict'\r\n\r\n\tconst $wrapper = $('.email-capture');\r\n\tconst $form = $wrapper.find('form');\r\n\tconst $submit = $form.find('button');\r\n\tconst $emailInput = $form.find('input[name=\"email\"]');\r\n\tconst $errorMessage = $wrapper.find('.js-error-message');\r\n\r\n\tfunction addUser(user) {\r\n\t\t$.ajax({\r\n\t\t\ttype: 'POST',\r\n\t\t\tdata: JSON.stringify(user),\r\n\t\t\turl: '/email-capture',\r\n\t\t\tcontentType: 'application/json',\r\n\t\t\tsuccess: () => {\r\n\t\t\t\t$wrapper.trigger('email-capture-complete', true);\r\n\t\t\t},\r\n\t\t\terror: () => {\r\n\t\t\t\t$wrapper.trigger('email-capture-complete', false);\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\t$submit.click((e) => {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\r\n\t\t$submit.prop('disabled', true);\r\n\r\n\t\tconst email = $emailInput.val();\r\n\t\tconst user = {\r\n\t\t\tlocal: {\r\n\t\t\t\temail,\r\n\t\t\t},\r\n\t\t\trecieveNewsletter: true,\r\n\t\t\tcreated: new Date(),\r\n\t\t\troles: [`beta-${$wrapper.attr('data-category')}`],\r\n\t\t};\r\n\t\t\r\n\t\taddUser(user);\r\n\t});\r\n\r\n\t$wrapper.on('email-capture-complete', (e, success) => {\r\n\t\te.stopPropagation();\r\n\r\n\t\tif(success) {\r\n\t\t\t$form.hide();\r\n\t\t\t$wrapper.find('.email-capture--sub-header').hide();\r\n\t\t\t$wrapper.find('.email-capture--header').text('Thanks for signing up. You\\'ll be the first to know when we open you beta. Happy travels!');\r\n\t\t} else {\r\n\t\t\t$submit.prop('disabled', false);\r\n\t\t\t$emailInput.val('');\r\n\t\t\t$errorMessage.slideDown(500);\r\n\t\t}\r\n\t});\r\n}(jQuery.noConflict());"]}