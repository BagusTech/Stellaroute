{"version":3,"sources":["controls/favorite/favorite.js"],"names":["$","duck","e","stopPropagation","preventDefault","data","button","$icon","icon","$button","attr","guide","isFavorite","card","prop","removeClass","type","JSON","stringify","url","contentType","success","error","err","addClass","triggerFavorite","trigger","find","console","off","on","favorite","jQuery","noConflict"],"mappings":"iBAAA,UAAAA,EAAAC,GAKCA,QAAAA,GAAAA,GAGCC,EAAEC,kBADHD,EAAAE,gBAECF,IAAEE,GAAFF,EAAAG,KAAAC,OAGMC,EAAQL,EAAEG,KAAKG,KADfC,EAAN,SAAkBJ,EAAlBK,KAAA,cACMH,GACNI,MAAMC,EAAAA,KAAaH,cACnBI,KAAMR,EAAOK,KAAA,aACZC,KAAAA,EAAOF,KAAA,aACPI,aAAcH,EAFFD,GAAbK,KAAA,YAAA,GAQAP,EAAMQ,YAAY,UAAlBR,EAAAA,MAGCS,KAAM,OADPhB,IAAA,YACCgB,KAAMC,KAAAC,UADAb,GAENc,YAAK,mBACLd,QAAMY,WACNG,EAAAA,KAAa,YAAA,GACbC,EAAAA,SAAS,UACRZ,EAAQK,KAAK,cAAYF,GACzBL,YAAe,4BAGfe,MAVK,SAAAC,GAWND,EAAOE,SAAA,UACNjB,OAAMiB,KAAAA,kEAMT,QAASC,GAAgBvB,GAAzBA,EAAAC,kBACCD,EAAEC,gBAGF,IAAMM,GAAUP,EAAEG,KAAKC,MAEvBG,GAAQiB,QAAQ,iBA7CjBzB,IAgDAD,EAAE,WAAFA,GAAES,GAAMT,EAAA,uBACDS,EAAUT,EAAE2B,KAAA,eAGZf,EAA4C,SAA/BH,EAAQC,KAAK,aAAhCkB,SAAMhB,IAAAA,GAGNH,EAAQoB,IAAI,QAASJ,GAAiBK,GAAG,SAAUxB,OAAQG,GAAUgB,GAArEhB,EAAQoB,IAAI,gBAASJ,GAAiBK,GAAG,iBAAkBrB,OAATA,EAAmBgB,KAAAA,GAArEM,MAPDC,OAAAC,aAAAhC","file":"favorite.min.js","sourcesContent":["/* global jQuery, duck */\r\n\r\nvoid function initFavorite($, duck) {\r\n\t'use strict';\r\n\r\n\tduck();\r\n\r\n\tfunction favorite(e) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\r\n\t\tconst $button = e.data.button;\r\n\t\tconst $icon = e.data.icon;\r\n\t\tconst isFavorite = $button.attr('isFavorite') === 'true';\r\n\t\tconst data = {\r\n\t\t\tguide: $button.attr('data-guide'),\r\n\t\t\tcard: $button.attr('data-card'),\r\n\t\t\tuser: $button.attr('data-user'),\r\n\t\t\taddFavorite: !isFavorite,\r\n\t\t}\r\n\r\n\t\t$button.prop('disabled', true);\r\n\t\t$icon.removeClass('hidden');\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: 'POST',\r\n\t\t\turl: '/favorite',\r\n\t\t\tdata: JSON.stringify(data),\r\n\t\t\tcontentType: 'application/json',\r\n\t\t\tsuccess: () => {\r\n\t\t\t\t$button.prop('disabled', false);\r\n\t\t\t\t$icon.addClass('hidden');\r\n\t\t\t\t$button.attr('isFavorite', !isFavorite)\r\n\t\t\t\t\t\t.toggleClass('favorite-button__active');\r\n\t\t\t},\r\n\t\t\terror: (err) => {\r\n\t\t\t\t$icon.addClass('hidden');\r\n\t\t\t\tbutton.text('Something went wrong, please refresh the page and try again');\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n\r\n\tfunction triggerFavorite(e) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\r\n\t\tconst $button = e.data.button;\r\n\r\n\t\t$button.trigger('duck.favorite');\r\n\t}\r\n\r\n\t$(() => {\r\n\t\tconst $button = $('.js-favorite-button');\r\n\t\tconst $icon = $button.find('.fa-spinner')\r\n\r\n\t\tconst isFavorite = $button.attr('isFavorite') === 'true';\r\n\t\tconsole.log(isFavorite);\r\n\r\n\t\t$button.off('click', triggerFavorite).on('click', {button: $button}, triggerFavorite);\r\n\t\t$button.off('duck.favorite', favorite).on('duck.favorite', {button: $button, icon: $icon}, favorite)\r\n\t});\r\n}(jQuery.noConflict(), duck)\r\n\r\n/*\r\nbutton.js-favorite-button.favorite-button(\r\n\tdata-guide=guide,\r\n\tdata-card=card,\r\n\tdata-user= user.Id,\r\n\ttype='submit',\r\n\tisFavorite= isFavorite,\r\n\tclass= isFavorite ? (card ? 'favorite-button__icon favorite-button__active' : 'favorite-button__button favorite-button__active') : (card ? 'favorite-button__icon' : 'favorite-button__button'))\r\n*/"]}