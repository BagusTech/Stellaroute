{"version":3,"sources":["controls/login/login.js"],"names":["$","duck","setValidation","$input","type","sendMagicLink","length","$parent","parent","find","remove","$sendMagicLink","addClass","trigger","attr","val","append","validateField","value","exists","isValidEmail","field","fineOne","$SignupPassphrase","$item","prop","each","i","item","$SignupPassphraseRepeat","val1","val2","closest","jQuery","noConflict"],"mappings":"iBAAA,UAAAA,EAAAC,GAGC,QAAAC,GAAAC,EAAAC,GAGC,GAAMC,GAAgBL,EAAAA,+bAgBnB,OAAA,UAAAM,GACK,MANPA,GAOCH,EAAGC,QAAS,oBAEJG,UAANH,GALDD,EAAOK,SAASC,KAAK,UAAUC,UAW3BH,UAAHH,EACCD,EAAMQ,QAAAA,mBAAmBN,WAP1B,GAAME,GAAUJ,EAAOK,QAcxBL,IAJEI,EAAAA,YAAeI,2BACfC,SAAA,aAZFC,QAAA,iBAAA,IAeA,IAAAV,EAAOU,KAAQ,wBAAfP,OAAA,CACA,GAAAK,GAAAX,EAAAK,EAzBHM,GAAAF,KAAA,wBAAAK,KAAA,OAAA,oBAAAX,EAAAY,OA4BAR,EAAAS,OAAAL,MAIAR,EAAMC,QAAcU,qBAFrB,QAASG,GAAcd,GAStBF,GAAKiB,GAASC,EAAOJ,MACrBX,EAAAD,EAAAW,KAAA,OAEDd,OAAQ,UAANI,GAAMJ,EAAAoB,aAAAF,OAIwFjB,GAAA,SAAMgB,QAANI,MAAAlB,EAAAW,KAAA,QAAAI,MAAAA,EAAAI,SAAA,GAAApB,EAAAC,EAAAC,QAH/FD,GAAMoB,QAAAA,oBAKNA,EAAAA,WACC,GAAMC,GAANxB,EAAA,mBACAwB,EAA2BxB,EAAA,yBAC1BA,GAAA,yCAAAyB,KAAA,mBAAA,KAAAA,KAAA,eAAA,WAAA,MAAAR,KAEAM,EAAIG,KAAgB,SAAAC,EAAAC,GACnBJ,GAAAA,GAAMX,EAANe,EACAJ,GAFDC,KAEO,eAAA,WAAA,MAAA,YACND,GAAAA,GAAMX,EAAQE,KAHXA,GAAIT,OAAS,EAMjBuB,EAAAA,QAAAA,oBATDL,EAAAX,QAAA,oBAaDgB,EAAwBH,QAAK,iBAGDG,EAAYH,KAAA,SAAAC,EAAAC,GACtC,GAAME,GAAON,EAAAA,EADdA,GAAMC,KAAK,eAAgB,WAAA,MAAM,YAIhC,GAAGK,GAAQC,EAAMhB,MACbe,EAAAA,EAAHE,QAAkB,QAAAvB,KAAA,mBAAAM,KAAlBe,IAEOC,IACNP,IAAMX,EACNW,EAAAX,QAAA,oBADAW,EAAMX,QAAQ,qBAXlBU,EAAAV,QAAA,oBAmBAoB,OAAOC,aAAcjC","file":"login.min.js","sourcesContent":["/* global jQuery, duck */\r\n\r\nvoid function initLogin($, duck) {\r\n\t'use strict';\r\n\r\n\tfunction setValidation($input, type) {\r\n\t\tconst sendMagicLink = $(`\r\n\t\t\t<div class='alert alert-danger p-A l-0 t-100 mt-Sm w-100 z-1'>\r\n\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\r\n\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\r\n\t\t\t\t</button>\r\n\t\t\t\t<h4 class='mt-0'>Email Already In Use</h4>\r\n\t\t\t\t<p class='fw-N'>If you forgot your password or haven't set one yet, <a class='js-magic-link-email' href='#'>Click Here</a></p>\r\n\t\t\t</div>\r\n\t\t`);\r\n\r\n\t\treturn (length) => {\r\n\t\t\tif (length === \"0\") {\r\n\t\t\t\t$input.trigger('passedValidation')\r\n\r\n\t\t\t\tif(type === 'email') {\r\n\t\t\t\t\t$input.parent().find('.alert').remove();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif(type === 'email') {\r\n\t\t\t\t\t$input.trigger('failedValidation', () => {\r\n\t\t\t\t\t\tconst $parent = $input.parent();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$parent.removeClass('has-success has-warning')\r\n\t\t\t\t\t\t\t.addClass('has-error')\r\n\t\t\t\t\t\t\t.trigger('checkIsValid', [true])\r\n\r\n\t\t\t\t\t\tif($parent.find('.js-magic-link-email').length === 0) {\r\n\t\t\t\t\t\t\tconst $sendMagicLink = $(sendMagicLink);\r\n\r\n\t\t\t\t\t\t\t$sendMagicLink.find('.js-magic-link-email').attr('href', `/send-magic-link/${$input.val()}`);\r\n\t\t\t\t\t\t\t$parent.append($sendMagicLink);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$input.trigger('failedValidation');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction validateField($input) {\r\n\t\tconst value = $input.val();\r\n\t\tconst type = $input.attr('type');\r\n\r\n\t\tif (type === 'email' && !$.isValidEmail(value)) {\r\n\t\t\t$input.trigger('failedValidation')\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tduck('Users').exists({field: $input.attr('name'), value, fineOne: true}, setValidation($input, type));\r\n\t}\t\r\n\r\n\t$(() => {\r\n\t\tconst $SignupPassphrase = $('.js-signup-pass');\r\n\t\tconst $SignupPassphraseRepeat = $('.js-signup-pass-repeat');\r\n\r\n\t\t$('.js-signup-email, .js-signup-username').prop('debounceValidate', 1000).prop('validateFunc', () => validateField);\r\n\r\n\t\t$SignupPassphrase.each((i, item) => {\r\n\t\t\tconst $item = $(item);\r\n\t\t\t$item.prop('validateFunc', () => () => {\r\n\t\t\t\tconst val = $item.val();\r\n\r\n\t\t\t\tif (val.length > 7) {\r\n\t\t\t\t\t$item.trigger('passedValidation');\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$item.trigger('failedValidation');\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$SignupPassphraseRepeat.trigger('validate');\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t$SignupPassphraseRepeat.each((i, item) => {\r\n\t\t\tconst $item = $(item);\r\n\r\n\t\t\t$item.prop('validateFunc', () => () => {\r\n\t\t\t\tconst val1 = $item.val();\r\n\t\t\t\tconst val2 = $item.closest('form').find('.js-signup-pass').val();\r\n\r\n\t\t\t\tif(val1 && val2) {\r\n\t\t\t\t\tif(val1 === val2) {\r\n\t\t\t\t\t\t$item.trigger('passedValidation');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$item.trigger('failedValidation');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$SignupPassphrase.trigger('validate');\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n}(jQuery.noConflict(), duck);"]}