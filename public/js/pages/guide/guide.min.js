"use strict";void function(e){function a(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=a.find('[data-sort="item"]'),d=e.data.expandeCollapseIcon,r=d.hasClass("fa-compress"),n=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="'+!!r+'"]').click(),t.addClass("guide-card--edit-mode"),d.toggleClass("fa-compress fa-expand"),n.removeClass("fa-pencil").addClass("fa-eye")}function t(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=e.data.expandeCollapseIcon,d=a.find(".js-card"),r=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="false"]').click(),t.removeClass("fa-expand").addClass("fa-compress"),r.hasClass("fa-eye")?d.trigger("exitEditMode"):d.trigger("enterEditMode"),r.toggleClass("fa-eye fa-pencil")}function d(e){e.data.cardsWrapper.find('[duck-button="add"]').addClass("hidden"),e.data.addCardIcon.removeClass("rotate-45")}function r(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,t=e.data.addCardIcon,r=a.find('[duck-button="add"]');r.removeClass("hidden"),t.hasClass("rotate-45")?d({data:{cardsWrapper:a,addCardIcon:t}}):t.addClass("rotate-45")}function n(a){var t=e(a),d=t.find('.panel-heading[role="tab"]'),r=t.find('[duck-field="style"] select'),n=t.find(".card-styles--preview"),o=t.find('[duck-type="string"] [duck-value]'),s=t.find(".js-card-title"),i=t.find('[duck-type="image"] [duck-value]'),c=t.find(".js-card-image"),l=t.find(".summernote"),p=t.find(".js-card-text"),u=t.find(".js-card-toggle");u.on("click",function(e){e.stopPropagation(),e.preventDefault(),t.parent().hasClass("guide-card--edit-mode")?t.trigger("exitEditMode"):t.trigger("enterEditMode")}),t.on("exitEditMode",function(){t.parent().removeClass("guide-card--edit-mode"),"false"===d.attr("aria-expanded")&&d.click()}),t.on("enterEditMode",function(){t.parent().addClass("guide-card--edit-mode")}),o.on("input",function(e){e.stopPropagation(),e.preventDefault();var a=o.val();a?s.removeClass("guide-card--placeholder").text(a):s.addClass("guide-card--placeholder").text("Card Title")}),l.on("summernote.change",function(e,a){a?p.removeClass("guide-card--placeholder").html(a):p.addClass("guide-card--placeholder").html("This is where the <strong>Text</strong> for the card will go.")}),r.on("input",function(e){e.stopPropagation(),e.preventDefault(),n.removeClass("card-styles--preview__active"),t.find('.card-styles--preview[card-style="'+r.val()+'"]').addClass("card-styles--preview__active")}),i.on("change",function(a){a.stopPropagation(),a.preventDefault();var t=i.val()?"https://s3-us-west-2.amazonaws.com/stellaroute/"+i.val().replace(".","-medium."):"images/no-image--small.svg";c.each(function(a,d){var r=e(d);r.removeClass("guide-card--img__no-img"),r.attr("style")?r.attr("style","background-image: url('"+t+"')"):r.attr("src",t)})}),t.on("click",".js-delete-card",function(a){a.stopPropagation(),a.preventDefault();var t=e(a.delegateTarget).parent().find(".js-delete-card-form");t.addClass("z-1").delay(10).addClass("o-1")}),t.parent().on("click",".js-cancel-delete",function(a){a.stopPropagation(),a.preventDefault();var t=e(a.delegateTarget).find(".js-delete-card-form");t.removeClass("o-1").delay(180).removeClass("z-1")})}e.fn.guideCard=function(){return this.each(function(e,a){n(a)})},e(function(){var d=e(".sub-header"),n=e("#GuideDetailsForm"),o=n.find('[duck-button="submit"] .fa'),s=n.find('[duck-button="edit"]'),i=s.find(".fa"),c=n.find('[duck-field="bannerImage"] [duck-value]'),l=e("#GuideCards"),p=l.find('[duck-button="submit"]').find(".fa"),u=e(".js-guide-cards"),f=e(".js-expand-collapse"),g=f.find(".fa"),m=e(".js-preview-cards"),v=m.find(".fa"),C=e(".js-add-card-start"),k=C.find(".fa"),b=e('<div class="alert alert-danger p-A z-1 l-0 r-0 t-0">Something went wrong, please try again.</div>');e.ajax({url:"/renderPug",data:{file:"../views/guides/cards/_card.pug",locals:{isMe:!0,card:{style:"big",title:"New Card",text:"New card text goes here."},startInEditMode:!0}},success:function(a){u.prop("ArrayItemTemplate",e(a))}}),e(".js-card").guideCard(),l.on("duck.form.submitted",function(e){e.stopPropagation(),p.toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!0)}),l.on("duck.form.success",function(e){e.stopPropagation(),p.toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!1),u.find(".js-card").trigger("exitEditMode"),v.removeClass("fa-eye").addClass("fa-pencil")}),l.on("duck.form.error",function(e){e.stopPropagation();var a=b.clone();u.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),p.toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!1)}),C.on("click",{cardsWrapper:u,addCardIcon:k},r),f.on("click",{cardsWrapper:u,expandeCollapseIcon:g,previewCardsIcon:v},a),m.on("click",{cardsWrapper:u,expandeCollapseIcon:g,previewCardsIcon:v},t),s.on("click",function(e){e.stopPropagation(),e.preventDefault(),i.toggleClass("fa-eye fa-pencil")}),n.on("duck.form.submitted",function(e){e.stopPropagation(),o.toggleClass("hidden")}),n.on("duck.form.success",function(e){e.stopPropagation();var a="https://s3-us-west-2.amazonaws.com/stellaroute/"+c.val().replace(".jpg","-large.jpg");n.modal("hide"),d.css("background-image",'url("'+a+'")'),o.toggleClass("hidden"),n.find('[duck-button="submit"]').prop("disabled",!1),s.click()}),n.on("duck.form.error",function(e){e.stopPropagation();var a=b.clone();n.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),o.toggleClass("hidden"),n.find('[duck-button="submit"]').prop("disabled",!1)})})}(jQuery.noConflict());
//# sourceMappingURL=guide.min.js.map
