"use strict";void function(e){function a(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,d=a.find('[data-sort="item"]'),t=e.data.expandeCollapseIcon,n=t.hasClass("fa-compress"),s=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="'+!!n+'"]').click(),d.addClass("guide-card--edit-mode"),t.toggleClass("fa-compress fa-expand"),s.removeClass("fa-pencil").addClass("fa-eye")}function d(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,d=e.data.expandeCollapseIcon,t=a.find(".js-card"),n=e.data.previewCardsIcon;a.find('[role="tab"][aria-expanded="false"]').click(),d.removeClass("fa-expand").addClass("fa-compress"),n.hasClass("fa-eye")?t.trigger("exitEditMode"):t.trigger("enterEditMode"),n.toggleClass("fa-eye fa-pencil")}function t(e){e.data.cardsWrapper.find('[duck-button="add"]').addClass("hidden"),e.data.addCardIcon.removeClass("fa-eye").addClass("fa-pencil")}function n(e){e.stopPropagation(),e.preventDefault();var a=e.data.cardsWrapper,d=e.data.addCardIcon,n=a.find('[duck-button="add"]');n.removeClass("hidden"),d.hasClass("fa-eye")?t({data:{cardsWrapper:a,addCardIcon:d}}):d.removeClass("fa-pencil").addClass("fa-eye")}function s(a){var d=e(a),t=d.find('.panel-heading[role="tab"]'),n=d.find('[duck-field="style"] select'),s=d.find(".card-styles--preview"),r=d.find('[duck-type="string"] [duck-value]'),o=d.find(".js-card-title"),i=d.find('[duck-type="image"]'),c=i.find("[duck-value]"),l=d.find(".js-card-image"),p=d.find('[duck-type="wysiwyg"]'),u=p.find(".summernote"),f=d.find(".js-card-text"),g=d.find(".js-card-toggle"),m=["section","sub","plain","white","danger","success","info"],v=["img","sub"];g.on("click",function(e){e.stopPropagation(),e.preventDefault(),d.parent().hasClass("guide-card--edit-mode")?d.trigger("exitEditMode"):d.trigger("enterEditMode")}),d.on("exitEditMode",function(){d.parent().removeClass("guide-card--edit-mode"),"false"===t.attr("aria-expanded")&&t.click()}),d.on("enterEditMode",function(){d.parent().addClass("guide-card--edit-mode")}),r.on("input",function(e){e.stopPropagation(),e.preventDefault();var a=r.val();a?o.removeClass("guide-card--placeholder").text(a):o.addClass("guide-card--placeholder").text("Card Title")}),u.on("summernote.change",function(e,a){a?f.removeClass("guide-card--placeholder").html(a):f.addClass("guide-card--placeholder").html("This is where the <strong>Text</strong> for the card will go.")}),n.on("input",function(e){e.stopPropagation(),e.preventDefault();var a=n.val();s.removeClass("card-styles--preview__active"),i.removeClass("hidden"),p.removeClass("hidden"),d.find('.card-styles--preview[card-style="'+a+'"]').addClass("card-styles--preview__active"),m.indexOf(a)>-1&&i.addClass("hidden"),v.indexOf(a)>-1&&p.addClass("hidden")}),c.on("change",function(a){a.stopPropagation(),a.preventDefault();var d=c.val()?"https://s3-us-west-2.amazonaws.com/stellaroute/"+c.val().replace(".","-medium."):"images/no-image--small.svg";l.each(function(a,t){var n=e(t);n.removeClass("guide-card--img__no-img"),n.attr("style")?n.attr("style","background-image: url('"+d+"')"):n.attr("src",d)})}),d.on("click",".js-delete-card",function(a){a.stopPropagation(),a.preventDefault();var d=e(a.delegateTarget).parent().find(".js-delete-card-form");d.addClass("z-1").delay(10).addClass("o-1")}),d.parent().on("click",".js-cancel-delete",function(a){a.stopPropagation(),a.preventDefault();var d=e(a.delegateTarget).find(".js-delete-card-form");d.removeClass("o-1").delay(180).removeClass("z-1")})}e.fn.guideCard=function(){return this.each(function(e,a){s(a)})},e(function(){var t=e(".sub-header"),s=e("#GuideDetailsForm"),r=s.find('[duck-button="submit"] .fa'),o=s.find('[duck-button="edit"]'),i=o.find(".fa"),c=s.find('[duck-field="bannerImage"] [duck-value]'),l=e("#GuideCards"),p=e(".js-guide-cards"),u=e(".js-expand-collapse"),f=u.find(".fa"),g=e(".js-preview-cards"),m=g.find(".fa"),v=e(".js-add-card-start"),C=v.find(".fa"),k=e('<div class="alert alert-danger p-A z-1 l-0 r-0 t-0">Something went wrong, please try again.</div>');e.ajax({url:"/renderPug",data:{file:"../views/guides/cards/_card.pug",locals:{isMe:!0,card:{style:"big"},startInEditMode:!0}},success:function(a){p.prop("ArrayItemTemplate",e(a))}}),e(".js-card").guideCard(),l.on("duck.form.submitted",function(e){e.stopPropagation(),l.find('[duck-button="submit"] .fa').toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!0)}),l.on("duck.form.success",function(e){e.stopPropagation(),l.find('[duck-button="submit"] .fa').toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!1),p.find(".js-card").trigger("exitEditMode"),m.removeClass("fa-eye").addClass("fa-pencil")}),l.on("duck.form.error",function(e){e.stopPropagation();var a=k.clone();p.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),l.find('[duck-button="submit"] .fa').toggleClass("fa-spinner fa-spin fa-floppy-o"),l.find('[duck-button="submit"]').prop("disabled",!1)}),v.on("click",{cardsWrapper:p,addCardIcon:C},n),u.on("click",{cardsWrapper:p,expandeCollapseIcon:f,previewCardsIcon:m},a),g.on("click",{cardsWrapper:p,expandeCollapseIcon:f,previewCardsIcon:m},d),o.on("click",function(e){e.stopPropagation(),e.preventDefault(),i.toggleClass("fa-eye fa-pencil")}),s.on("duck.form.submitted",function(e){e.stopPropagation(),r.toggleClass("hidden")}),s.on("duck.form.success",function(e){e.stopPropagation();var a="https://s3-us-west-2.amazonaws.com/stellaroute/"+c.val().replace(".jpg","-large.jpg");s.modal("hide"),t.css("background-image",'url("'+a+'")'),r.toggleClass("hidden"),s.find('[duck-button="submit"]').prop("disabled",!1),o.click()}),s.on("duck.form.error",function(e){e.stopPropagation();var a=k.clone();s.prepend(a),setTimeout(function(){a.slideUp(270)},3e3),setTimeout(function(){a.remove()},3270),r.toggleClass("hidden"),s.find('[duck-button="submit"]').prop("disabled",!1)})})}(jQuery.noConflict());
//# sourceMappingURL=guide.min.js.map
