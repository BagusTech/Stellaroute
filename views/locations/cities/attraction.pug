extends ../../layout.pug

block content
	if !user || !attraction
		.media-bg-img.request-page-header
			.container
				h1= attraction && attraction.names && attraction.names.display || 'Unknown Attraction'

		.container.ptb-Sm
			small
				a.fc-G(href= `/${city.countryUrl}/${city.url}`)= `< Back to ${city.names.display}`

			.content-card
				h2.content-card--header Coming soon!
				p.lead.m-0!= `More information about ${attraction && attraction.names && attraction.names.display || 'this'} is currently being developed. Please check back soon for more information. If you would like to help contribute content, please shoot us an email at <a href='mailto:info@stellaroute.com'>info@stellaroute.com</a>`
	else
		div(style='background: rgba(0, 0, 0, 0) url("https://d2lm6fxwu08ot6.cloudfront.net/img-thumbs/960w/XPABV05EQ9.jpg") no-repeat scroll center 57% / cover;')
				.bg-Dkr.p-R
					if user && user.isAdmin
						button.btn.btn-primary.p-A.r-Sm.t-Sm.d-N.d-B--sm(data-toggle='modal', data-target='#EditAttractionForm') Edit
						.bg-W.p-A.p-Xs.r-Sm.b-0.z-1.d-N.d-B--sm= attraction.Id
					.container.ptb-0
						ol.breadcrumb
							li.active Midwest
							li.active: a(href=`/${city.countryUrl}/${city.url}`)= city.names.display
							li.active: a(href=`/${city.countryUrl}/${city.url}#Attractions`)= `Attractions`
						h1= attraction.names.display
							small.ml-Md= attraction.tagline


		if user && user.isAdmin
			+modal('EditAttractionForm')(class='modal-lg')
				+attractionForm('update', attraction)

		.container
			.row
				.col-xs-12.col-sm-6.col-md-8.f-R
					.content-card.p-0
						if attraction.images && attraction.images.length > 2
							div(data-function='banner')
								for img, i in attraction.images
									div(data-banner='item')
										img.w-100(src=img, alt=`${attraction.names.display} Banner ${i+1}`)
						else 
							img.w-100(src= attraction.cardImage ? attraction.cardImage : 'http://placebear.com/300/300', alt= attraction.names.display)
						.lead.fc-W.m-0.p-Sm.bg-Dkst.p-A.b-0.l-0.r-0(style='z-index: 2;')!= attraction.description

					if attraction.needToKnow && attraction.needToKnow[0].description && wysiwygHasData(attraction.needToKnow[0].description)
						.content-card
							h2.content-card--header Travel Hacks

							+accordion(attraction.needToKnow.sort(sortByOrder))(class='row', data-allow-multiple='true')

					if subAttractions
						h2.fc-G Attractions in #{attraction.names.display}
						.masonry.masonry-grid-1.masonry-grid-2--md
							for subAttraction in subAttractions
								a.masonry--item(href=`/${city.countryUrl}/${city.url}/attraction/${subAttraction.url}`)
									+card(subAttraction.cardImage, subAttraction.names.display, null, null, subAttraction.description)

				.col-xs-12.col-sm-6.col-md-4
					if wysiwygHasData(attraction.price) || wysiwygHasData(attraction.hours) || wysiwygHasData(attraction.address)
						+contentCard('Quick Info')
							if wysiwygHasData(attraction.price)
								.mb-Sm
									span.d-B.f-L.mt-XXs(data-icon='fa fa-tag')
									.ml-Md!= attraction.price
							if wysiwygHasData(attraction.hours)
								.mb-Sm
									span.d-B.f-L.mt-XXs(data-icon='fa fa-clock-o')
									.ml-Md!= attraction.hours
							if wysiwygHasData(attraction.address)
								.mb-Sm
									span.d-B.f-L.mt-XXs(data-icon='fa fa-map-marker')
									.ml-Md!= attraction.address

					if attraction.orientation && (wysiwygHasData(attraction.orientation.description) || attraction.orientation.map ||wysiwygHasData(attraction.orientation.gettingThere))
						+contentCard('Orientation')
							if wysiwygHasData(attraction.orientation.description)
								div!= attraction.orientation.description
							
							if attraction.orientation.map
								button.bg-N.bw-0.p-0(type='button', data-toggle='modal', data-target='#MapModal', tab-index='1')
									img.w-100(src= attraction.orientation.map)

							if wysiwygHasData(attraction.orientation.gettingThere)
								.clear
									h3.mt-Md.pl-XXs.f-L.fs-16.lh-B(data-icon='fa fa-subway')
										span.sr-only Getting There

									.ml-Lg.mt-Md!= attraction.orientation.gettingThere

				
						if attraction.orientation.map
							+modal('MapModal')
								.ta-C(style='overflow-x: scroll;')
									img(src=attraction.orientation.map)
								a.btn.btn-default(data-dismiss='modal') Close
										
				
				if siblingAttractions
					.col-xs-12.col-sm-6.col-md-4
						h2.fc-G Other Attractions in #{parentAttraction.names.display}
						a.d-B(href=`/${city.countryUrl}/${city.url}/attraction/${parentAttraction.url}`)
							img.w-100(src=parentAttraction.cardImage, alt= parentAttraction.names.display)
							.p-Sm.bg-Purp
								h3.fc-W.mt-0= parentAttraction.names.display
								.fc-W.fw-N!= parentAttraction.description

						for siblingAttraction, i in siblingAttractions
							a.d-F.fai-Str.fc-I.fw-N.bw-0.brw-Sm.bs-S.bc-G(href=`/${city.countryUrl}/${city.url}/attraction/${siblingAttraction.url}`, class= i % 2 !== 0 ? 'bg-W' : '')
									.w-25(style= `background: url('${siblingAttraction.cardImage}') no-repeat scroll center center / cover`)
									.w-75.p-Sm
										h4.mt-0= siblingAttraction.names.display 
										!= siblingAttraction.description
						.bw-0.bbw-Sm.bs-S.bc-G

				if attraction.nearbyAttractions
					.col-xs-12.col-sm-6.col-md-4
						h2.fc-G Nearby Attractions

						.masonry.masonry-grid-1(class= nearbyAttractions.length > 1 ? '.masonry-grid-2--sm' : '')
							for nearbyAttraction in nearbyAttractions
								a.masonry--item(href=`/${city.countryUrl}/${city.url}/attraction/${nearbyAttraction.url}`, target='_blank')
									+card(nearbyAttraction.cardImage, nearbyAttraction.names.display, null, null, nearbyAttraction.description)

				if attraction.quickFacts && attraction.quickFacts[0] && wysiwygHasData(attraction.quickFacts[0].description)
					.col-xs-12.col-sm-6.col-md-8.f-R
						.content-card
							h2.content-card--header Fun Facts

							+accordion(attraction.quickFacts.sort(sortByOrder))(class='row', data-allow-multiple='true')