extends ../../layout.pug

block content
	if !user || !attraction
		.media-bg-img.request-page-header
			.container
				h1= attraction && attraction.names && attraction.names.display || 'Unknown Attraction'

		.container.ptb-Sm
			small
				a.fc-G(href= `/${city.countryUrl}/${city.url}`)= `< Back to ${city.names.display}`

			.content-card
				h2.content-card--header Coming soon!
				p.lead.m-0!= `More information about ${attraction && attraction.names && attraction.names.display || 'this'} is currently being developed. Please check back soon for more information. If you would like to help contribute content, please shoot us an email at <a href='mailto:info@stellaroute.com'>info@stellaroute.com</a>`
	else
		div(style='background: rgba(0, 0, 0, 0) url("https://d2lm6fxwu08ot6.cloudfront.net/img-thumbs/960w/XPABV05EQ9.jpg") no-repeat scroll center 57% / cover;')
				.bg-Dkr.p-R
					if user && user.isAdmin
						button.btn.btn-primary.p-A.r-Sm.t-Sm(data-toggle='modal', data-target='#EditAttractionForm') Edit
						.bg-W.p-A.p-Xs.r-Sm.b-0.z-1= attraction.Id
					.container.ptb-0
						ol.breadcrumb
							li.active United Sates
							li.active Midwest
							li.active: a(href=`/${city.countryUrl}/${city.url}`)= city.names.display
						h1= attraction.names.display
							small.ml-Md= attraction.tagline


		if user && user.isAdmin
			+modal('EditAttractionForm')
				+attractionForm('update', attraction)
				div(duck-table='Attractions', duck-key='Id', duck-key-value= attraction.Id, duck-function='delete')
					button.btn.btn-danger(duck-button='submit') Delete

		.container
			.row
				.col-xs-12.col-sm-6.col-md-8.f-R
					.content-card.p-0
						if attraction.images && attraction.images.length > 2
							div(data-function='banner')
								for img, i in attraction.images
									img(src=img, alt=`${attraction.names.display} Banner ${i+1}`, data-banner-item)
						else 
							img.w-100(src= attraction.cardImage ? attraction.cardImage : 'http://placebear.com/300/300', alt= attraction.names.display)
						.lead.fc-W.m-0.p-Sm.bg-Dkst.p-A.b-0.l-0.r-0!= attraction.description						

					if attraction.needToKnow
						.content-card
							h2.content-card--header Need to Know

							.row(data-function='accordion', data-allow-multiple='true')
								for advice, i in attraction.needToKnow.sort((a, b) => {if(a.order > b.order){return -1;}if(a.order < b.order){return 1;}return 0;})
									h3.m-0.p-Sm(role='tab',aria-expanded= i === 0 ? 'true' : 'false', data-function='toggle', data-event='tab-change', data-target='this i')
										i.fa.fa-chevron-down.an-F.mr-Sm(aria-hidden='true', data-toggle='rotate-Neg180', class= i === 0 ? 'rotate-Neg180' : '')
										= advice.title
									div.p-Sm.pt-0(role='tabpanel', aria-hidden= i === 0 ? 'false' : 'true')!= advice.description

					if subAttractions
						h2.fc-G Attractions in #{attraction.names.display}
						.masonry.masonry-grid-1.masonry-grid-2--md
							for subAttraction in subAttractions
								a.masonry--item(href=`/${city.countryUrl}/${city.url}/${subAttraction.url}`)
									+card(subAttraction.cardImage, subAttraction.names.display, null, null, subAttraction.description)

				.col-xs-12.col-sm-6.col-md-4
					if attraction.price || attraction.hours || attraction.address
						.content-card
							h2.content-card--header Quick Info
							if attraction.price
								.mb-Sm
									span.d-B.f-L.mt-XXs(data-icon='fa fa-tag')
									.ml-Md!= attraction.price
							if attraction.hours
								.mb-Sm
									span.d-B.f-L.mt-XXs(data-icon='fa fa-clock-o')
									.ml-Md!= attraction.hours
							if attraction.address
								.mb-Sm
									span.d-B.f-L.mt-XXs(data-icon='fa fa-map-marker')
									.ml-Md!= attraction.address

					if attraction.orientation
						.content-card
							h2.content-card--header Orientation
							if attraction.orientation.description && attraction.orientation.description !== '<p><br></p>' && attraction.orientation.description !== '<br>'
								div!= attraction.orientation.description
							
							if attraction.orientation.map
								button.bg-N.bw-0.p-0(type='button', data-toggle='modal', data-target='#MapModal', tab-index='1')
									img.w-100(src= attraction.orientation.map)

							h3
								span.fs-16(data-icon='fa fa-subway')
								| &nbsp;Getting There

							div!= attraction.orientation.gettingThere

				
						if attraction.orientation.map
							.modal.fade#MapModal(tab-index='-1', role='dialog')
								.modal-dialog(role='document', style='width: 100%; max-width: 1200px')
									.modal-content.p-Md
										img.w-100(src=attraction.orientation.map)
				
				if attraction.nearbyAttractions
					.col-xs-12.col-sm-6.col-md-4
						h2.fc-G Nearby Attractions

						.masonry.masonry-grid-1(class= nearbyAttractions.length > 1 ? '.masonry-grid-2--sm' : '')
							for nearbyAttraction in nearbyAttractions
								a.masonry--item(href=`/${city.countryUrl}/${city.url}/${nearbyAttraction.url}`, target='_blank')
									+card(nearbyAttraction.cardImage, nearbyAttraction.names.display, null, null, nearbyAttraction.description)

				if attraction.quickFacts && attraction.quickFacts[0].description !== '<p><br></p>' && attraction.quickFacts[0].description !== '<br>'
					.col-xs-12.col-sm-6.col-md-8.f-R
						.content-card
							h2.content-card--header Fun Facts
							ul.ls-N.p-0
								for fact in attraction.quickFacts
									li
										h3= fact.title
										div!= fact.description